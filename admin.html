<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Yogaholic</title>
    <link rel="apple-touch-icon" sizes="180x180" href="img/favicon_logo_yogaholic/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="img/favicon_logo_yogaholic/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="img/favicon_logo_yogaholic/favicon-16x16.png">
    <link rel="manifest" href="img/favicon_logo_yogaholic/site.webmanifest">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="vendors/linericon/style.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="vendors/owl-carousel/owl.carousel.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="vendors/nice-select/css/nice-select.css">
    <!-- main css -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gaegu&display=swap" rel="stylesheet">
    <style>
        @font-face {
            font-family: '123456';
            src: url('fonts/123456.woff') format('woff'),
                url('fonts/123456.woff2') format('woff2'),
                url('fonts/123456.svg#123456') format('svg'),
                url('fonts/123456.eot'),
                url('fonts/123456.eot?#iefix') format('embedded-opentype'),
                url('fonts/123456.ttf') format('truetype');

            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        .chinese_character_circle {
            font-family: '123456';
            color: #754C24;
        }

        .gaegu-regular {
            font-family: "Gaegu", sans-serif;
            font-weight: 400;
            font-style: normal;
        }

        h5.font_slogan {
            color: #754C24;
            font-size: 60px;
        }

        img.bear-img {
            margin: 100px;
        }

        .icon {
            margin-right: 10px;
        }



        @media (max-width: 500px) {
            img.smaller {
                width: 300px;
            }
        }

        /* Add new styles for login popup */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .login-popup {
            background: white;
            padding: 30px;
            border-radius: 8px;
            text-align: center;
        }

        .login-popup input {
            margin: 10px 0;
            padding: 8px;
            width: 200px;
        }

        .login-popup button {
            padding: 8px 20px;
            background: #754C24;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <!-- Add login popup HTML -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-popup">
            <h3>請輸入密碼</h3>
            <input type="password" id="passcode" placeholder="Enter passcode">
            <br>
            <button onclick="checkPasscode()">登入</button>
        </div>
    </div>

    <!-- Add login script before other content -->
    <script>
        function checkPasscode() {
            const passcode = document.getElementById('passcode').value;
            if (passcode === 'embraceangelyogis') {
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadExistingPosts();
            } else {
                alert('密碼錯誤');
            }
        }

        // Prevent access to page content before login
        document.addEventListener('DOMContentLoaded', function () {
            if (sessionStorage.getItem('loggedIn') !== 'true') {
                document.getElementById('loginOverlay').style.display = 'flex';
            }
        });
    </script>

    <!--================ Start Header Area =================-->
    <header class="header_area">
        <div class="main_menu">
            <nav class="navbar navbar-expand-lg navbar-light">
                <div class="container">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <a class="navbar-brand logo_h" href="index.html"><img src="img/logo2.png" width="80px" alt=""></a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse"
                        data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse offset" id="navbarSupportedContent">
                        <ul class="nav navbar-nav menu_nav justify-content-end">

                            <li class="nav-item"><a class="nav-link" href="index.html">首頁</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    </header>
    <!--================ End Header Area =================-->


    <!--================Start Portfolio Area =================-->
    <section class="portfolio_area padding" id="portfolio">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="main_title text-left">
                        <h2 class="font_color"> 最新資訊 </h2>

                    </div>
                </div>
            </div>
            <div class="filters portfolio-filter">
                <ul>
                    <li class="active" data-filter="*">所有資訊</li>
                    <li data-filter=".info_ig">學習</li>
                    <li data-filter=".book">繪本</li>
                    <li data-filter=".workshop">工作坊</li>
                    <li data-filter=".special">節日優惠</li>
                </ul>
            </div>

            <div class="filters-content">
                <div class="row portfolio-grid justify-content-center">
                    <!-- Content will be dynamically populated by newpost.js -->
                </div>
            </div>
        </div>
        </div>
    </section>
    <!--================End Portfolio Area =================-->
    </div>

    <!--================Footer Area =================-->
    <footer class="footer_area">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-12">
                    <div class="footer_top flex-column">
                        <div class="footer_logo">
                            <a href="#">
                                <img src="img/logo.png" width="80px" alt="">
                            </a>
                            <h4>Follow Me</h4>
                        </div>
                        <div class="footer_social">
                            <a href="https://www.instagram.com/yogaholic.studio/" target="_blank"><i
                                    class="fa fa-instagram"></i></a>
                            <a href="https://wa.me/85269357929" target="_blank"><i class="fa fa-whatsapp"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row footer_bottom justify-content-center">
                <p class="col-lg-8 col-sm-12 footer-text">
                    <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                    Copyright &copy;
                    <script>document.write(new Date().getFullYear());</script> All rights reserved | This template is
                    made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com"
                        target="_blank">Colorlib</a>
                    <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                </p>
            </div>
        </div>
    </footer>
    <!--================End Footer Area =================-->

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/popper.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/stellar.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="vendors/nice-select/js/jquery.nice-select.min.js"></script>
    <script src="vendors/isotope/imagesloaded.pkgd.min.js"></script>
    <script src="vendors/isotope/isotope-min.js"></script>
    <script src="vendors/owl-carousel/owl.carousel.min.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/mail-script.js"></script>
    <!--gmaps Js-->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjCGmQ0Uq4exrzdcL6rvxywDDOvfAu6eE"></script>
    <script src="js/gmaps.min.js"></script>
    <script src="js/theme.js"></script>

    <!-- Add after the login section -->
    <div class="container mt-5" id="adminPanel" style="display: block;">
        <h3>管理 Instagram 貼文</h3>

        <!-- Add new post form -->
        <div class="card mb-4">
            <div class="card-body">
                <h4>新增貼文</h4>
                <div class="form-group">
                    <label>Instagram 嵌入碼:</label>
                    <textarea class="form-control" id="newIframeCode" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>類別:</label>
                    <select class="form-control" id="newPostType" multiple>
                        <option value="info_ig">學習</option>
                        <option value="book">繪本</option>
                        <option value="workshop">工作坊</option>
                        <option value="special">節日優惠</option>
                    </select>
                    <small class="form-text text-muted">按住 Ctrl (Windows) 或 Command (Mac) 來選擇多個類別</small>
                </div>
                <button class="btn btn-primary mt-2" onclick="addNewPost()">新增</button>
            </div>
        </div>

        <!-- List of existing posts -->
        <div class="card">
            <div class="card-body">
                <h4>現有貼文</h4>
                <div id="existingPosts"></div>
            </div>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/11.1.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.1.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore-compat.js"></script>
    <script src="firebase.js"></script>
    <!-- Add before closing </body> tag -->

    <script src="newpost.js"></script>
    <!-- <script>
        // Show admin panel after login
        function checkPasscode() {
            const passcode = document.getElementById('passcode').value;
            if (passcode === 'embraceangelyogis') {
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadExistingPosts();
            } else {
                alert('密碼錯誤');
            }
        }

        // Load existing posts
        function loadExistingPosts() {
            const postsDiv = document.getElementById('existingPosts');
            postsDiv.innerHTML = '';

            db.collection('instagram_posts').get().then((snapshot) => {
                snapshot.forEach((doc) => {
                    const post = doc.data();
                    const postElement = document.createElement('div');
                    postElement.className = 'mb-3 p-3 border';
                    postElement.innerHTML = `
                    <div class="mb-2">
                        <strong>類別:</strong> ${post.type}
                    </div>
                    <div class="mb-2">
                        <strong>嵌入碼:</strong>
                        <pre class="border p-2">${post.iframe}</pre>
                    </div>
                    <button class="btn btn-danger" onclick="deletePost('${doc.id}')">刪除</button>
                `;
                    postsDiv.appendChild(postElement);
                });
            });
        }

        // Add new post
        function addNewPost() {
            const iframe = document.getElementById('newIframeCode').value;
            const typeSelect = document.getElementById('newPostType');

            // Get all selected options and join their values with spaces
            const selectedTypes = Array.from(typeSelect.selectedOptions)
                .map(option => option.value)
                .join(' ');

            if (!iframe || !selectedTypes) {
                alert('請填寫所有欄位');
                return;
            }

            db.collection('instagram_posts').add({
                iframe: iframe,
                type: selectedTypes,  // This will now be a space-separated string of types
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                document.getElementById('newIframeCode').value = '';
                typeSelect.value = '';  // Clear selection
                loadExistingPosts();
                alert('貼文已新增');
            }).catch((error) => {
                console.error('Error adding post: ', error);
                alert('新增貼文時發生錯誤');
            });
            loadPortfolioPosts();
        }

        // Delete post
        function deletePost(docId) {
            if (confirm('確定要刪除這個貼文嗎？')) {
                db.collection('instagram_posts').doc(docId).delete().then(() => {
                    alert('貼文已刪除');
                    loadExistingPosts();
                }).catch((error) => {
                    alert('錯誤: ' + error);
                });
            }
        }

        // Load posts on page load
        function loadPortfolioPosts() {
            const portfolioGrid = document.querySelector('.portfolio-grid');

            db.collection('instagram_posts').orderBy('timestamp', 'desc').get().then((snapshot) => {
                portfolioGrid.innerHTML = ''; // Clear existing posts

                snapshot.forEach((doc) => {
                    const post = doc.data();
                    const postElement = document.createElement('div');
                    postElement.className = `col-lg-4 col-md-6 all ${post.type}`;
                    postElement.innerHTML = `
                    <div class="portfolio_box">
                        <div class="single_portfolio">
                            ${post.iframe}
                        </div>
                    </div>
                `;
                    portfolioGrid.appendChild(postElement);
                });

                // Reinitialize Instagram embeds
                if (window.instgrm) {
                    window.instgrm.Embeds.process();
                }
            });
        }

        // Load posts when document is ready
        document.addEventListener('DOMContentLoaded', function () {
            if (sessionStorage.getItem('loggedIn') === 'true') {
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadExistingPosts();
            }
            loadPortfolioPosts();
        });
    </script> -->



</body>

</html>